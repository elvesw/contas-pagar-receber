<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/WEB-INF/templates/Layout.xhtml"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="titulo">Cadastros</ui:define>
	<ui:define name="centro">

		<h:form id="formPrincipal">
			<h:panelGroup layout="block" rendered="#{pessoaBean.telaDeCadastro}">
				<h1 class="aw-page-title">Cadastro</h1>
			</h:panelGroup>
			<h:panelGroup layout="block"
				rendered="#{not pessoaBean.telaDeCadastro}">
				<h1 class="aw-page-title">Lista de cadastros</h1>
			</h:panelGroup>

			<p:messages id="msg" autoUpdate="true" closable="true" />

			<h:panelGroup layout="block" id="div-cadastro"
				rendered="#{pessoaBean.telaDeCadastro}">

				<div style="display: inline-block; padding-top: 4px; width: 100%">
					<div style="float: left">
						<p:commandButton value="Voltar" update=":formPrincipal"
							action="#{pessoaBean.voltar()}" styleClass="btn btn-default"
							icon="fa fa-fw fa-mail-reply" immediate="true" process="@form" />
					</div>
					<div style="float: right">
						<p:commandButton value="Salvar" update=":formPrincipal"
							action="#{pessoaBean.salvar()}" styleClass="btn btn-success"
							icon="fa fa-fw fa-floppy-o" />
					</div>
				</div>
				
				<div class="ui-fluid" style="border-top: 1px solid #E6E6E6;">
					<p:panelGrid columns="3" layout="grid"
						columnClasses="ui-grid-col-5,ui-grid-col-2,ui-grid-col-1"
						styleClass="ui-panelgrid-blank">

						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="Nome" styleClass="label-formulario" />
							<p:inputText id="nome" value="#{pessoaBean.pessoa.nome}"
								required="true" requiredMessage="O nome é obrigatório." autocomplete="off"/>
						</p:panelGrid>

						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="CPF/CNPJ" styleClass="label-formulario" />
							<p:inputText id="cpfcnpj" value="#{pessoaBean.pessoa.cpfCnpj}" autocomplete="off"
								onkeypress="return mascaraCpfCnpj(this,cpfCnpj)">
								<f:validator validatorId="cpfCnpjValidator" />
							</p:inputText>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="Ativo" styleClass="label-formulario" />
							<p:selectOneMenu value="#{pessoaBean.pessoa.cadastroAtivo}">
								<f:selectItem itemLabel="SIM" itemValue="#{true}" />
								<f:selectItem itemLabel="NÃO" itemValue="#{false}" />
							</p:selectOneMenu>
						</p:panelGrid>

					</p:panelGrid>
				</div>
				
				<div class="ui-fluid">
					<p:panelGrid columns="2" layout="grid"
						columnClasses="ui-grid-col-2,ui-grid-col-3"
						styleClass="ui-panelgrid-blank">

						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="Telefone" styleClass="label-formulario" />
							<p:inputMask id="telefone" mask="(99)9999-9999" autocomplete="off"
								value="#{pessoaBean.pessoa.telefone}" />
						</p:panelGrid>

						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="Email" styleClass="label-formulario" />
							<p:inputText id="email" value="#{pessoaBean.pessoa.email}" autocomplete="off"/>
						</p:panelGrid>

					</p:panelGrid>
				</div>


				<div class="ui-fluid">
					<p:panelGrid columns="4" layout="grid"
						columnClasses="ui-grid-col-2,ui-grid-col-3,ui-grid-col-2,ui-grid-col-1">


						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							    <p:outputLabel value="Cep" styleClass="label-formulario" />
				 			    <h:form style="position:relative;">
				 			    	<div>
					 			    	<p:inputMask mask="99999-999" id="cep" value="#{pessoaBean.pessoa.cep}" autocomplete="off" required="false" size="20" style="width:calc(100% - 33px);"/>
					 			    	<p:commandButton styleClass="btn btn-info"
										icon="fa fa-fw fa-search" 
										update=":formPrincipal:logradouro :formPrincipal:bairro :formPrincipal:cidade :formPrincipal:uf :formPrincipal:msg :formPrincipal"
										actionListener="#{pessoaBean.encontraCep(pessoaBean.pessoa.cep)}" style="position:absolute;"/>
				 			    	</div>
				 			    </h:form>
							<!-- Deu trabalho fazer esse button ficar sempre ao lado do input-->
						</p:panelGrid>


						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="Logradouro" styleClass="label-formulario" />
							<p:inputText id="logradouro" autocomplete="off"
								value="#{pessoaBean.pessoa.logradouro}" />
						</p:panelGrid>

						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="Bairro" styleClass="label-formulario" />
							<p:inputText id="bairro" value="#{pessoaBean.pessoa.bairro}" autocomplete="off"/>
						</p:panelGrid>

						<p:panelGrid columns="1" layout="grid"
							columnClasses="ui-grid-col-12">
							<p:outputLabel value="Número" styleClass="label-formulario" />
							<p:inputText id="numero" value="#{pessoaBean.pessoa.numero}" autocomplete="off"/>
						</p:panelGrid>

					</p:panelGrid>
				</div>
				
				<div class="ui-fluid">
					<p:panelGrid columns="3" layout="grid" columnClasses="ui-grid-col-2,ui-grid-col-1,ui-grid-col-4">

						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="Cidade" styleClass="label-formulario" />
							<p:inputText id="cidade" value="#{pessoaBean.pessoa.cidade}" autocomplete="off"/>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="Uf" styleClass="label-formulario" />
							<p:inputText id="uf" value="#{pessoaBean.pessoa.uf}" autocomplete="off"/>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="Complemento" styleClass="label-formulario" />
							<p:inputText id="complemento" value="#{pessoaBean.pessoa.complemento}" autocomplete="off"/>
						</p:panelGrid>
	
					</p:panelGrid>
				</div>
				
<!-- 				<div class="ui-fluid">
					<p:panelGrid columns="3" layout="grid" columnClasses="ui-grid-col-2,ui-grid-col-1,ui-grid-col-4">

						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="label teste" styleClass="label-formulario"/>
			 			    <p:inputText placeholder="input teste"/>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="label teste" styleClass="label-formulario"/>
			 			    <p:inputText placeholder="input teste"/>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<p:outputLabel value="label teste" styleClass="label-formulario"/>
			 			    <p:inputText placeholder="input teste"/>
						</p:panelGrid>
	
					</p:panelGrid>
				</div> -->
				
				<div class="ui-fluid" style="border-top: 1px solid #E6E6E6;">
					<p:panelGrid columns="3" layout="grid" columnClasses="ui-grid-col-2,ui-grid-col-2,ui-grid-col-2">
					
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<h:panelGroup layout="block">
								<p:selectBooleanCheckbox value="#{pessoaBean.pessoa.cliente}" />
								<p:outputLabel value="Cliente" styleClass="label-formulario"
							style="vertical-align:20%;margin:5px" />
							</h:panelGroup>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<h:panelGroup layout="block">
								<p:selectBooleanCheckbox value="#{pessoaBean.pessoa.funcionario}" />
								<p:outputLabel value="Funcionário" styleClass="label-formulario"
							style="vertical-align:20%;margin:5px" />
							</h:panelGroup>
						</p:panelGrid>
						
						<p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12">
							<h:panelGroup layout="block">
								<p:selectBooleanCheckbox value="#{pessoaBean.pessoa.fornecedor}" />
								<p:outputLabel value="Fornecedor" styleClass="label-formulario"
									style="vertical-align:20%;margin:5px" />
							</h:panelGroup>
						</p:panelGrid>
						
					</p:panelGrid>
			  </div>

			</h:panelGroup>

			<h:panelGroup layout="block" id="div-lista"
				rendered="#{not pessoaBean.telaDeCadastro}">

				<div style="display: inline-block; padding-top: 4px; width: 100%" class="remove-span-text">
					<div style="float: left">
						<p:commandButton value="Novo" update=":formPrincipal"
							action="#{pessoaBean.novo()}" styleClass="btn btn-primary"
							icon="fa fa-fw fa-user-plus" immediate="true" process="@form" />
					</div>
					<div style="float: right">
						<p:selectOneMenu value="#{pessoaBean.filtro.perfil}" autoWidth="off">
							<p:ajax update=":formPrincipal"
								listener="#{pessoaBean.addMessageFiltro(pessoaBean.filtro.perfil)}" />
							<f:selectItems value="#{pessoaBean.perfilDePessoaEnums}"
								var="perfil" itemValue="#{perfil}" itemLabel="#{perfil}" />
						</p:selectOneMenu>
						<p:selectOneMenu value="#{pessoaBean.filtro.cadastroAtivo}" autoWidth="off" style="margin-left:0.7em;">
							<p:ajax update=":formPrincipal"
								listener="#{pessoaBean.addMessageCadastroAtivo(pessoaBean.filtro.cadastroAtivo)}" />
							<f:selectItem itemLabel="Ativos" itemValue="#{true}" />
							<f:selectItem itemLabel="Desativados" itemValue="#{false}" />
						</p:selectOneMenu>
					</div>
				</div>

				<p:dataTable var="pessoa" value="#{pessoaBean.model}" reflow="true"
					lazy="true" rowIndexVar="rowIx" id="dataTableLista" rows="12"
					emptyMessage="Nenhum cadastro ..." paginator="true"
					paginatorPosition="bottom">

					<p:column headerText="ID" width="3%">
						<h:outputText value="#{pessoa.id}" />
					</p:column>

					<p:column headerText="Nome">
						<h:outputText value="#{pessoa.nome}" />
					</p:column>

					<p:column headerText="Cliente" width="8%">
						<h:outputText value="#{pessoa.cliente ? 'sim':'não'}" />
					</p:column>
					<p:column headerText="Fornecedor" width="8%">
						<h:outputText value="#{pessoa.fornecedor ? 'sim':'não'}" />
					</p:column>
					<p:column headerText="Funcionário" width="8%">
						<h:outputText value="#{pessoa.funcionario ? 'sim':'não'}" />
					</p:column>


					<p:column headerText="Ações" width="11%" selectRow="false">
							<div class="ui-acoes-datatable">
									
								<p:commandLink immediate="true" styleClass="ui-command-link"
									action="#{pessoaBean.editar(pessoa)}"
									update=":formPrincipal"
									title="Alterar" process=":formPrincipal" >
									<span><i class="fa fa-fw fa-pencil"></i></span>
								</p:commandLink>
								
								<p:commandLink styleClass="ui-command-link"
									action="#{pessoaBean.excluir(pessoa)}"
									update=":formPrincipal" title="Excluir">
									<span><i class="fa fa-fw fa-trash"></i></span>
								</p:commandLink>
									
							</div>
					</p:column>
					
					<f:facet name="footer">
						Total de : #{pessoaBean.model.rowCount}
				</f:facet>
				</p:dataTable>
			</h:panelGroup>

		</h:form>
	</ui:define>
</ui:composition>